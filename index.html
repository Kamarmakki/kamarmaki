<!DOCTYPE html>
<html lang="<?php language_attributes(); ?>" dir="<?php echo get_locale() === 'ar' ? 'rtl' : 'ltr'; ?>">
<head>
  <meta charset="<?php bloginfo('charset'); ?>">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><?php wp_title('|', true, 'right'); ?></title>
  <link rel="profile" href="https://gmpg.org/xfn/11">
  <link rel="pingback" href="<?php bloginfo('pingback_url'); ?>">

  <!-- Preload critical fonts -->
  <link rel="preload" href="<?php echo esc_url(get_theme_file_uri('assets/fonts/inter-subset.woff2')); ?>" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="<?php echo esc_url(get_theme_file_uri('assets/fonts/cairo-subset.woff2')); ?>" as="font" type="font/woff2" crossorigin>

  <!-- Theme stylesheet -->
  <link rel="stylesheet" href="<?php echo esc_url(get_theme_file_uri('style.css')); ?>">

  <!-- DNS-Prefetch external domains -->
  <link rel="dns-prefetch" href="//www.googletagmanager.com">

  <?php wp_head(); ?>
</head>

<body class="font-sans bg-white text-gray-900 antialiased">
  <!-- Skip to content -->
  <a class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary-600 text-white px-4 py-2 rounded" href="#main"><?php _e('Skip to content', 'kamar'); ?></a>

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white shadow">
    <div class="container mx-auto px-4 flex items-center justify-between h-16">
      <!-- Logo -->
      <a href="<?php echo esc_url(home_url('/')); ?>" aria-label="<?php bloginfo('name'); ?>">
        <img src="<?php echo esc_url(get_theme_file_uri('assets/img/logo.svg')); ?>" alt="<?php bloginfo('name'); ?>" class="h-8">
      </a>

      <!-- Desktop Menu -->
      <nav class="hidden md:flex space-x-6" aria-label="<?php esc_attr_e('Primary', 'kamar'); ?>">
        <?php
          wp_nav_menu([
            'theme_location' => 'primary',
            'container'      => false,
            'menu_class'     => 'flex space-x-6',
            'fallback_cb'    => false,
          ]);
        ?>
      </nav>

      <!-- Mobile toggle -->
      <button id="nav-toggle" class="md:hidden p-2" aria-expanded="false" aria-controls="mobile-nav">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-nav" class="hidden md:hidden border-t">
      <div class="container mx-auto px-4 py-2">
        <?php
          wp_nav_menu([
            'theme_location' => 'primary',
            'container'      => false,
            'menu_class'     => 'space-y-2',
          ]);
        ?>
      </div>
    </div>
  </header>

  <!-- Breadcrumb -->
  <?php get_template_part('template-parts/sections/breadcrumb'); ?>

  <!-- Main Content -->
  <main id="main" class="min-h-[50vh]">
    <?php
      if (have_posts()) :
        while (have_posts()) : the_post();
          the_content();   // Gutenberg blocks
        endwhile;
      else :
    ?>
      <div class="container mx-auto px-4 py-16 text-center">
        <h1 class="text-4xl font-bold mb-4"><?php _e('Nothing found', 'kamar'); ?></h1>
        <p><?php _e('It seems we can&rsquo;t find what you&rsquo;re looking for.', 'kamar'); ?></p>
      </div>
    <?php endif; ?>
  </main>

  <!-- Scroll-to-top -->
  <?php get_template_part('template-parts/sections/scroll-top'); ?>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-8">
    <div class="container mx-auto px-4 text-center text-sm">
      &copy; <?php echo date('Y'); ?> <?php bloginfo('name'); ?>
    </div>
  </footer>

  <!-- Inline SVG sprite (icons) -->
  <svg aria-hidden="true" style="position:absolute;width:0;height:0;overflow:hidden">
    <defs>
      <symbol id="icon-up" viewBox="0 0 24 24">
        <path fill="none" stroke="currentColor" stroke-width="2" d="M18 15l-6-6-6 6"/>
      </symbol>
      <symbol id="icon-menu" viewBox="0 0 24 24">
        <path fill="none" stroke="currentColor" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
      </symbol>
    </defs>
  </svg>

  <!-- Scripts -->
  <script src="<?php echo esc_url(get_theme_file_uri('assets/js/app.js')); ?>" defer></script>
  <script src="<?php echo esc_url(get_theme_file_uri('assets/js/analytics.js')); ?>" async></script>

  <!-- Service Worker -->
  <script defer>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('<?php echo esc_url(get_theme_file_uri('assets/js/sw.js')); ?>');
    }
  </script>

  <?php wp_footer(); ?>
</body>
</html>
